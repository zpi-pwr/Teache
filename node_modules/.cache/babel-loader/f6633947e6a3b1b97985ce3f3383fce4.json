{"ast":null,"code":"import _objectSpread from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _taggedTemplateLiteral from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/src/components/MainPage.js\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    font-size: 1.5em;\\n    right: 5vw;\\n    top: 1vh;\\n    text-align: right;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    top: 5%;\\n    left: 50%;\\n    width: 90vw;\\n    height: 80vh;\\n    transform: translate(-50%);\\n    display: grid;\\n    grid-gap: 4px;\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from \"react\";\nimport ChatGroup from './ChatGroup';\nimport bgPic from \"../assets/mntnFHD_compressed_cut.jpeg\";\nimport Message from './Message';\nimport { connect } from \"react-redux\";\nimport GroupsComponent from \"./GroupsComponent\";\nimport ChatComponent from \"./ChatComponent\";\nimport styled from 'styled-components';\nimport DetailsComponent from \"./DetailsComponent\";\nimport '../styles/mainPage.scss';\nimport { Messages } from \"../data/Messages\";\nimport { Mutation, Query, graphql, compose } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport AdvertsComponent from \"./AdvertsComponent\";\nimport { SEND_MESSAGE_GQL, getConversationGql, GET_ME } from \"../queries/gql\";\nimport { InstallMetamask, UnlockMetamask, TokenTransferForm } from \"./Metamask\";\nimport TeacheCoin from \"../tokens/TeacheCoin\";\nvar Container = styled.div(_templateObject());\nvar styleOptCollapsed = {\n  gridTemplateColumns: '230px auto' // gridTemplateRows: '95%',\n\n};\nvar styleOptUnCollapsed = {\n  gridTemplateColumns: '230px auto 320px' // gridTemplateRows: '95%',\n\n};\nvar Balance = styled.div(_templateObject2());\n\nvar MainPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MainPage, _Component);\n\n  function MainPage(props) {\n    var _this;\n\n    _classCallCheck(this, MainPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MainPage).call(this, props)); // const {conversations, groups} = this.props;\n\n    _this.closeDialogs = function () {\n      _this.setState({\n        modalDialogs: {\n          installMetamaskVisible: false,\n          unlockMetamaskVisible: false,\n          transferFormVisible: false\n        }\n      });\n    };\n\n    _this.handleTokenTransfer = function () {\n      var installMetamask = false;\n      var unlockMetamask = false;\n      var transferForm = false;\n\n      if (!_this.isWeb3) {\n        installMetamask = true;\n      } else if (_this.isWeb3Locked) {\n        unlockMetamask = true;\n      } else {\n        transferForm = true;\n      }\n\n      _this.setState({\n        modalDialogs: {\n          installMetamaskVisible: installMetamask,\n          unlockMetamaskVisible: unlockMetamask,\n          transferFormVisible: transferForm\n        }\n      });\n    };\n\n    _this.handleKeyPress = function (event) {\n      if (event.key === 'Enter') {\n        _this.handleSend();\n      }\n    };\n\n    _this.openMainItem = function () {\n      _this.setState({\n        mainItemActive: true,\n        activeConversation: null\n      });\n\n      console.log(\"Open Main Item\");\n    };\n\n    _this.groupChanged = function (id) {\n      console.log(\"group changed: \", id);\n\n      _this.setState({\n        activeConversation: id,\n        mainItemActive: false\n      });\n    };\n\n    _this.showDetails = function (id) {\n      console.log(id);\n    };\n\n    _this.findActive = function (conversation) {\n      var activeConversation = _this.state.activeConversation;\n      return conversation.id === activeConversation;\n    };\n\n    _this.onNewData = function (wallet) {\n      if (_this.state.wallet !== _this.state.activeEthWallet) {\n        _this.setState({\n          activeEthWallet: wallet\n        });\n\n        console.log(\"active wallet: \".concat(wallet));\n      }\n    };\n\n    _this.state = {\n      inputMessage: '',\n      activeConversation: 0,\n      mainItemActive: true,\n      width: 0,\n      isCollapsed: false,\n      userID: '5ca1c9a11c9d4400003e3590',\n      nickname: \"Monteth\",\n      modalDialogs: {\n        installMetamaskVisible: false,\n        unlockMetamaskVisible: false,\n        transferFormVisible: false\n      }\n    };\n    _this.isWeb3 = false;\n    _this.isWeb3Locked = false;\n    _this.updateWindowDimensions = _this.updateWindowDimensions.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.loadBalance = _this.loadBalance.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.checkWeb3Compatibility = _this.checkWeb3Compatibility.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(MainPage, [{\n    key: \"loadBalance\",\n    value: function loadBalance() {\n      var _this2 = this;\n\n      if (this.isWeb3) {\n        window.web3.eth.getCoinbase(function (error, coinbase) {\n          if (false) {\n            console.log(error);\n          } else {\n            var token = _this2.state.TeacheCoin.token;\n            token.balanceOf(coinbase, function (error, response) {\n              if (!error) {\n                var balance = response.c[0] / 10000;\n                balance = balance >= 0 ? balance : 0;\n\n                _this2.setState({\n                  TeacheCoin: _objectSpread({}, _this2.state.TeacheCoin, {\n                    balance: balance,\n                    symbol: TeacheCoin.symbol,\n                    decimal: '1e' + TeacheCoin.decimal\n                  })\n                }, function () {\n                  console.log(_this2.state);\n                });\n              }\n            });\n          }\n        });\n      }\n    }\n  }, {\n    key: \"checkWeb3Compatibility\",\n    value: function checkWeb3Compatibility() {\n      var _this3 = this;\n\n      if (window.web3) {\n        this.isWeb3 = true;\n        window.web3.eth.getCoinbase(function (error, coinbase) {\n          if (error || coinbase === null) {\n            _this3.isWeb3Locked = true;\n          } else {\n            _this3.isWeb3Locked = false;\n\n            _this3.setState({\n              TeacheCoin: _objectSpread({}, _this3.state.TeacheCoin, {\n                account: coinbase,\n                token: window.web3.eth.contract(TeacheCoin.abi).at(TeacheCoin.address)\n              })\n            }, function () {\n              _this3.loadBalance();\n            });\n          }\n        });\n      } else {\n        this.isWeb3 = false;\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this4 = this;\n\n      this.updateWindowDimensions();\n      window.addEventListener('resize', this.updateWindowDimensions);\n      window.addEventListener('load', this.checkWeb3Compatibility);\n\n      if (window.web3) {\n        window.web3.currentProvider.publicConfigStore.on('update', function () {\n          _this4.checkWeb3Compatibility();\n        });\n      }\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      window.removeEventListener('resize', this.updateWindowDimensions);\n    }\n  }, {\n    key: \"updateWindowDimensions\",\n    value: function updateWindowDimensions() {\n      var w = window.innerWidth;\n      this.setState({\n        width: w,\n        isCollapsed: w <= 960\n      });\n    }\n  }, {\n    key: \"handleSend\",\n    value: function handleSend() {\n      var message = this.state.inputMessage;\n      console.log(\"Sending message: \".concat(message));\n\n      if (message) {\n        var id_conv = this.state.activeConversation;\n        var id_sender = this.state.userID;\n        this.props.sendMessageGql({\n          variables: {\n            content: message,\n            id_conv: id_conv,\n            id_sender: id_sender\n          }\n        });\n        this.setState(function (prevState) {\n          prevState.inputMessage = '';\n          return prevState;\n        });\n      }\n    }\n  }, {\n    key: \"getGroups\",\n    value: function getGroups() {\n      var _this5 = this;\n\n      return React.createElement(Query, {\n        query: GET_ME,\n        variables: {\n          nickname: this.state.nickname\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, function (_ref) {\n        var loading = _ref.loading,\n            error = _ref.error,\n            data = _ref.data;\n        if (loading) return \"Loading...\";\n        if (error) return \"Error! \".concat(error);\n        return data.me.conversations.map(function (conv, index) {\n          return React.createElement(ChatGroup, {\n            key: index,\n            id: conv.id,\n            url: conv.avatarUrl,\n            name: conv.name,\n            handleClick: _this5.groupChanged,\n            active: conv.id === _this5.state.activeConversation,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 216\n            },\n            __self: this\n          }, _this5.onNewData(conv.ethWallet, conv.name));\n        });\n      });\n    }\n  }, {\n    key: \"handleChangeInput\",\n    value: function handleChangeInput(event) {\n      var value = event.target.value;\n      this.setState({\n        inputMessage: value\n      });\n      console.log(\"input\");\n    }\n  }, {\n    key: \"getMessages\",\n    value: function getMessages() {\n      var _this6 = this;\n\n      var activeConversation = this.state.activeConversation;\n\n      if (activeConversation !== 0) {\n        return React.createElement(Query, {\n          query: getConversationGql,\n          variables: {\n            activeConversation: activeConversation\n          },\n          pollInterval: 2000,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 280\n          },\n          __self: this\n        }, function (_ref2) {\n          var loading = _ref2.loading,\n              error = _ref2.error,\n              data = _ref2.data;\n          if (loading) return 'Loading...';\n          if (error) return \"Error! \".concat(error);\n          console.log(\"data\");\n          console.log(data);\n          return data.conversation.messages.map(function (message, index) {\n            return React.createElement(Message, {\n              key: index,\n              model: message,\n              isActive: message.sender.id === _this6.state.userID,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 287\n              },\n              __self: this\n            });\n          });\n        });\n      } else {\n        return \"No conversation\";\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      var _this$state = this.state,\n          userID = _this$state.userID,\n          activeConversation = _this$state.activeConversation,\n          isCollapsed = _this$state.isCollapsed,\n          mainItemActive = _this$state.mainItemActive,\n          inputMessage = _this$state.inputMessage;\n      console.log(\"this.props\");\n      console.log(this.props);\n      var messagesList = this.getMessages();\n      var groupsCompList = this.getGroups();\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, React.createElement(Container, {\n        style: isCollapsed ? styleOptCollapsed : styleOptUnCollapsed,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, React.createElement(GroupsComponent, {\n        mainItemActive: mainItemActive,\n        openMainItem: this.openMainItem,\n        list: groupsCompList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }), this.state.mainItemActive ? React.createElement(AdvertsComponent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }) : React.createElement(ChatComponent, {\n        handleOver: this.showDetails,\n        userId: userID,\n        onSendToken: this.handleTokenTransfer,\n        conversationID: this.state.activeConversation,\n        messages: messagesList,\n        inputMessage: inputMessage,\n        onChange: function onChange(event) {\n          return _this7.handleChangeInput(event);\n        },\n        onKeyPress: this.handleKeyPress,\n        onClick: function onClick() {\n          return _this7.handleSend();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326\n        },\n        __self: this\n      }), !isCollapsed ? React.createElement(DetailsComponent, {\n        isMainActive: this.state.mainItemActive,\n        activeConv: activeConversation,\n        userId: userID,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338\n        },\n        __self: this\n      }) : null), this.isWeb3 && !this.isWeb3Locked ? React.createElement(Balance, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }, \"Balance: \", this.state.TeacheCoin.balance + \" \" + this.state.TeacheCoin.symbol, \" \") : null, React.createElement(InstallMetamask, {\n        close: this.closeDialogs,\n        show: this.state.modalDialogs.installMetamaskVisible,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 349\n        },\n        __self: this\n      }), React.createElement(UnlockMetamask, {\n        close: this.closeDialogs,\n        show: this.state.modalDialogs.unlockMetamaskVisible,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }), this.isWeb3 && !this.isWeb3Locked ? React.createElement(TokenTransferForm, {\n        teacheCoin: this.state.TeacheCoin,\n        activeConv: activeConversation,\n        show: this.state.modalDialogs.transferFormVisible,\n        close: this.closeDialogs,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 353\n        },\n        __self: this\n      }) : null);\n    }\n  }]);\n\n  return MainPage;\n}(Component);\n\nfunction mapStateToProps(state) {// const {conversations, groups} = state.chatReducer;\n  // const {adverts} = state.advertReducer;\n  // return {conversations, groups, adverts};\n  // return { adverts };\n}\n\nexport default compose( // graphql(getConversationGql, {\n//     options: (props) => ({\n//         variables: {\n//             activeConversation: props.activeConversation\n//         }\n//     })\n// }),\ngraphql(SEND_MESSAGE_GQL, {\n  name: 'sendMessageGql'\n}))(MainPage); // export default MainPage = connect(mapStateToProps)(MainPage);","map":{"version":3,"sources":["/home/przemek/Data/Programowanie/PWr/ZPI/Teache/frontend/src/components/MainPage.js"],"names":["React","Component","ChatGroup","bgPic","Message","connect","GroupsComponent","ChatComponent","styled","DetailsComponent","Messages","Mutation","Query","graphql","compose","gql","AdvertsComponent","SEND_MESSAGE_GQL","getConversationGql","GET_ME","InstallMetamask","UnlockMetamask","TokenTransferForm","TeacheCoin","Container","div","styleOptCollapsed","gridTemplateColumns","styleOptUnCollapsed","Balance","MainPage","props","closeDialogs","setState","modalDialogs","installMetamaskVisible","unlockMetamaskVisible","transferFormVisible","handleTokenTransfer","installMetamask","unlockMetamask","transferForm","isWeb3","isWeb3Locked","handleKeyPress","event","key","handleSend","openMainItem","mainItemActive","activeConversation","console","log","groupChanged","id","showDetails","findActive","conversation","state","onNewData","wallet","activeEthWallet","inputMessage","width","isCollapsed","userID","nickname","updateWindowDimensions","bind","loadBalance","checkWeb3Compatibility","window","web3","eth","getCoinbase","error","coinbase","token","balanceOf","response","balance","c","symbol","decimal","account","contract","abi","at","address","addEventListener","currentProvider","publicConfigStore","on","removeEventListener","w","innerWidth","message","id_conv","id_sender","sendMessageGql","variables","content","prevState","loading","data","me","conversations","map","conv","index","avatarUrl","name","ethWallet","value","target","messages","sender","messagesList","getMessages","groupsCompList","getGroups","handleChangeInput","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\"\nimport ChatGroup from './ChatGroup'\nimport bgPic from \"../assets/mntnFHD_compressed_cut.jpeg\";\nimport Message from './Message'\n\nimport { connect } from \"react-redux\";\nimport GroupsComponent from \"./GroupsComponent\";\nimport ChatComponent from \"./ChatComponent\";\nimport styled from 'styled-components'\nimport DetailsComponent from \"./DetailsComponent\";\nimport '../styles/mainPage.scss'\nimport { Messages } from \"../data/Messages\";\nimport { Mutation, Query, graphql, compose } from 'react-apollo'\nimport gql from 'graphql-tag'\nimport AdvertsComponent from \"./AdvertsComponent\";\nimport { SEND_MESSAGE_GQL, getConversationGql, GET_ME } from \"../queries/gql\"\n\nimport { InstallMetamask, UnlockMetamask, TokenTransferForm } from \"./Metamask\"\n\nimport TeacheCoin from \"../tokens/TeacheCoin\";\n\nconst Container = styled.div`\n    position: absolute;\n    top: 5%;\n    left: 50%;\n    width: 90vw;\n    height: 80vh;\n    transform: translate(-50%);\n    display: grid;\n    grid-gap: 4px;`;\n\nconst styleOptCollapsed = {\n    gridTemplateColumns: '230px auto',\n    // gridTemplateRows: '95%',\n};\n\nconst styleOptUnCollapsed = {\n    gridTemplateColumns: '230px auto 320px',\n    // gridTemplateRows: '95%',\n};\n\nconst Balance = styled.div`\n    position: absolute;\n    font-size: 1.5em;\n    right: 5vw;\n    top: 1vh;\n    text-align: right;\n`\n\nclass MainPage extends Component {\n\n    constructor(props) {\n        super(props);\n        // const {conversations, groups} = this.props;\n\n        this.state = {\n            inputMessage: '',\n            activeConversation: 0,\n            mainItemActive: true,\n            width: 0,\n            isCollapsed: false,\n            userID: '5ca1c9a11c9d4400003e3590',\n            nickname: \"Monteth\",\n            modalDialogs: {\n                installMetamaskVisible: false,\n                unlockMetamaskVisible: false,\n                transferFormVisible: false\n            }\n        };\n\n        this.isWeb3 = false;\n        this.isWeb3Locked = false;\n\n        this.updateWindowDimensions = this.updateWindowDimensions.bind(this)\n        this.loadBalance = this.loadBalance.bind(this)\n        this.checkWeb3Compatibility = this.checkWeb3Compatibility.bind(this)\n    }\n\n    loadBalance() {\n        if (this.isWeb3) {\n            window.web3.eth.getCoinbase((error, coinbase) => {\n                if (false) {\n                    console.log(error)\n                } else {\n                    let token = this.state.TeacheCoin.token\n                    token.balanceOf(coinbase, (error, response) => {\n                        if (!error) {\n                            let balance = response.c[0] / 10000\n                            balance = balance >= 0 ? balance : 0\n\n                            this.setState({\n                                TeacheCoin: {\n                                    ...this.state.TeacheCoin,\n                                    balance: balance,\n                                    symbol: TeacheCoin.symbol,\n                                    decimal: '1e' + TeacheCoin.decimal\n                                }\n                            }, () => {\n                                console.log(this.state)\n                            })\n                        }\n                    })\n                }\n            })\n        }\n    }\n\n    checkWeb3Compatibility() {\n        if (window.web3) {\n            this.isWeb3 = true;\n            window.web3.eth.getCoinbase((error, coinbase) => {\n                if (error || coinbase === null) {\n                    this.isWeb3Locked = true;\n                } else {\n                    this.isWeb3Locked = false;\n                    this.setState({\n                        TeacheCoin: {\n                            ...this.state.TeacheCoin,\n                            account: coinbase,\n                            token: window.web3.eth.contract(TeacheCoin.abi).at(TeacheCoin.address)\n                        }\n                    }, () => {\n                        this.loadBalance()\n                    })\n                }\n            })\n        } else {\n            this.isWeb3 = false;\n        }\n    }\n\n    closeDialogs = () => {\n        this.setState({\n            modalDialogs: {\n                installMetamaskVisible: false,\n                unlockMetamaskVisible: false,\n                transferFormVisible: false\n            }\n        })\n    }\n\n    handleTokenTransfer = () => {\n        let installMetamask = false\n        let unlockMetamask = false\n        let transferForm = false\n\n        if (!this.isWeb3) {\n            installMetamask = true\n        } else if (this.isWeb3Locked) {\n            unlockMetamask = true\n        } else {\n            transferForm = true\n        }\n\n        this.setState({\n            modalDialogs: {\n                installMetamaskVisible: installMetamask,\n                unlockMetamaskVisible: unlockMetamask,\n                transferFormVisible: transferForm\n            }\n        })\n    }\n\n    componentDidMount() {\n        this.updateWindowDimensions();\n        window.addEventListener('resize', this.updateWindowDimensions)\n        window.addEventListener('load', this.checkWeb3Compatibility)\n\n        if (window.web3) {\n            window.web3.currentProvider.publicConfigStore.on('update', () => {\n                this.checkWeb3Compatibility()\n            })\n        }\n    }\n\n    componentWillMount() {\n        window.removeEventListener('resize', this.updateWindowDimensions)\n    }\n\n    updateWindowDimensions() {\n        const w = window.innerWidth;\n        this.setState({\n            width: w,\n            isCollapsed: w <= 960\n        });\n    }\n\n    handleSend() {\n        const message = this.state.inputMessage;\n        console.log(`Sending message: ${message}`);\n        if (message) {\n            const id_conv = this.state.activeConversation;\n            const id_sender = this.state.userID;\n\n            this.props.sendMessageGql({\n                variables: {\n                    content: message,\n                    id_conv: id_conv,\n                    id_sender: id_sender\n                }\n            });\n            this.setState(prevState => {\n                prevState.inputMessage = '';\n                return prevState\n            });\n        }\n    }\n\n    getGroups() {\n        return <Query query={GET_ME} variables={{ nickname: this.state.nickname }}>\n            {({ loading, error, data }) => {\n                if (loading) return `Loading...`;\n                if (error) return `Error! ${error}`;\n\n                return data.me.conversations.map((conv, index) =>\n                    <ChatGroup\n                        key={index}\n                        id={conv.id}\n                        url={conv.avatarUrl}\n                        name={conv.name}\n                        handleClick={this.groupChanged}\n                        active={conv.id === this.state.activeConversation}>\n                        {this.onNewData(conv.ethWallet, conv.name)}\n                    </ChatGroup>);\n            }}\n        </Query>\n    };\n\n    handleKeyPress = (event) => {\n        if (event.key === 'Enter') {\n            this.handleSend();\n        }\n    };\n\n    handleChangeInput(event) {\n        const { value } = event.target;\n        this.setState({\n            inputMessage: value\n        });\n        console.log(\"input\")\n    }\n\n    openMainItem = () => {\n        this.setState({\n            mainItemActive: true,\n            activeConversation: null\n        });\n        console.log(\"Open Main Item\")\n    };\n\n\n    groupChanged = (id) => {\n        console.log(\"group changed: \", id);\n        this.setState({\n            activeConversation: id,\n            mainItemActive: false\n        });\n    };\n\n    showDetails = (id) => {\n        console.log(id);\n    };\n\n    findActive = (conversation) => {\n        const { activeConversation } = this.state;\n        return conversation.id === activeConversation\n    };\n\n    onNewData = (wallet) => {\n        if (this.state.wallet !== this.state.activeEthWallet) {\n            this.setState({\n                activeEthWallet: wallet,\n            })\n            console.log(`active wallet: ${wallet}`)\n        }\n    }\n    getMessages() {\n        const activeConversation = this.state.activeConversation;\n        if (activeConversation !== 0) {\n            return (<Query query={getConversationGql} variables={{ activeConversation }} pollInterval={2000}>\n                {({ loading, error, data }) => {\n                    if (loading) return 'Loading...';\n                    if (error) return `Error! ${error}`;\n                    console.log(\"data\");\n                    console.log(data);\n                    return data.conversation.messages.map((message, index) =>\n                        <Message\n                            key={index}\n                            model={message}\n                            isActive={message.sender.id === this.state.userID}>\n                        </Message>);\n                }}\n            </Query>)\n        } else {\n            return \"No conversation\"\n        }\n    }\n\n    render() {\n        const {\n            userID,\n            activeConversation,\n            isCollapsed,\n            mainItemActive,\n            inputMessage,\n        } = this.state;\n\n        console.log(\"this.props\")\n        console.log(this.props)\n\n        const messagesList = this.getMessages();\n\n\n        const groupsCompList = this.getGroups()\n\n        return (\n            <div>\n                <Container\n                    style={isCollapsed ? styleOptCollapsed : styleOptUnCollapsed}>\n                    <GroupsComponent\n                        mainItemActive={mainItemActive}\n                        openMainItem={this.openMainItem}\n                        list={groupsCompList} />\n                    {this.state.mainItemActive\n                        ? <AdvertsComponent />\n                        : <ChatComponent\n                            handleOver={this.showDetails}\n                            userId={userID}\n                            onSendToken={this.handleTokenTransfer}\n                            conversationID={this.state.activeConversation}\n                            messages={messagesList}\n                            inputMessage={inputMessage}\n                            onChange={event => this.handleChangeInput(event)}\n                            onKeyPress={this.handleKeyPress}\n                            onClick={() => this.handleSend()} />\n                    }\n                    {!isCollapsed ?\n                        <DetailsComponent\n                            isMainActive={this.state.mainItemActive}\n                            activeConv={activeConversation}\n                            userId={userID}\n                        /> : null}\n                </Container>\n\n                {this.isWeb3 && !this.isWeb3Locked\n                    ? <Balance>Balance: {this.state.TeacheCoin.balance + \" \" + this.state.TeacheCoin.symbol} </Balance>\n                    : null}\n\n                <InstallMetamask close={this.closeDialogs} show={this.state.modalDialogs.installMetamaskVisible} />\n                <UnlockMetamask close={this.closeDialogs} show={this.state.modalDialogs.unlockMetamaskVisible} />\n\n                {this.isWeb3 && !this.isWeb3Locked\n                    ? <TokenTransferForm\n                        teacheCoin={this.state.TeacheCoin}\n                        activeConv={activeConversation}\n                        show={this.state.modalDialogs.transferFormVisible}\n                        close={this.closeDialogs} />\n                    : null}\n            </div>\n        )\n    }\n}\n\nfunction mapStateToProps(state) {\n    // const {conversations, groups} = state.chatReducer;\n    // const {adverts} = state.advertReducer;\n    // return {conversations, groups, adverts};\n    // return { adverts };\n}\n\nexport default compose(\n    // graphql(getConversationGql, {\n    //     options: (props) => ({\n    //         variables: {\n    //             activeConversation: props.activeConversation\n    //         }\n    //     })\n    // }),\n    graphql(SEND_MESSAGE_GQL, { name: 'sendMessageGql' })\n)(MainPage);\n\n// export default MainPage = connect(mapStateToProps)(MainPage);\n"]},"metadata":{},"sourceType":"module"}