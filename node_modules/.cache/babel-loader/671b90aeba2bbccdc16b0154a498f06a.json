{"ast":null,"code":"import _classCallCheck from \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/przemek/Data/Programowanie/PWr/ZPI/frontend/src/components/LoginPage.js\";\nimport React, { Component } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport Alert from \"react-s-alert\";\nimport { ACCESS_TOKEN } from \"../constraints\";\nimport { userService } from \"../service/userService\";\nimport { connect } from \"react-redux\";\n\nvar LoginPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(LoginPage, _Component);\n\n  function LoginPage(props, context) {\n    var _this;\n\n    _classCallCheck(this, LoginPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LoginPage).call(this, props, context));\n\n    _this.login = function () {\n      var dispatch = _this.props.dispatch; // console.log(this.state.userInfo.email);\n      // console.log(this.state.userInfo.password);\n\n      dispatch(userService.login(_this.state.userInfo.email, _this.state.userInfo.password));\n      console.log(JSON.stringify(_this.state.userInfo));\n      fetch(\"http://localhost:3000/auth/login\", {\n        method: \"post\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(_this.state.userInfo)\n      }).then(function (data) {\n        return data.json().then(function (response) {\n          localStorage.setItem(ACCESS_TOKEN, response.accessToken);\n\n          _this.setState({\n            redirectToReferer: true\n          });\n        });\n      }).catch(function (error) {\n        Alert.error(error && error.message);\n      }); // then(data => console.log(data));\n      // console.log(this.state.data);\n      //\n      // this.props.auth.authenticate(() => {\n      //     this.setState(({\n      //         redirectToReferer: true,\n      //     }))\n      // });\n\n      console.log(\"Logged in!\"); // console.log(this.props.auth.isAuthenticated);\n    };\n\n    _this.handleInput = function (event) {\n      var _event$target = event.target,\n          name = _event$target.name,\n          value = _event$target.value;\n\n      if (name === 'email') {\n        _this.setState(function (prevState) {\n          prevState.userInfo.email = value;\n          return prevState;\n        });\n      } else if (name === 'password') {\n        _this.setState(function (prevState) {\n          prevState.userInfo.password = value;\n          return prevState;\n        });\n      }\n    };\n\n    _this.state = {\n      redirectToReferer: false,\n      userInfo: {\n        email: \"\",\n        password: \"\"\n      }\n    };\n    return _this;\n  }\n\n  _createClass(LoginPage, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, this.state.redirectToReferer ? React.createElement(Redirect, {\n        to: {\n          pathname: '/index'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }) : null, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, \"You must log in to view the page\"), React.createElement(\"input\", {\n        name: \"email\",\n        type: \"text\",\n        value: this.state.login,\n        onChange: function onChange(event) {\n          return _this2.handleInput(event);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        name: \"password\",\n        type: \"password\",\n        value: this.state.password,\n        onChange: function onChange(event) {\n          return _this2.handleInput(event);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.login,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, \"Log in\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          return console.log(_this2.state.userInfo);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, \"LOG\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          return console.log(localStorage.getItem(ACCESS_TOKEN));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, \"LOG TOKEN\"), React.createElement(\"button\", {\n        onClick: function onClick() {\n          return console.log(localStorage.removeItem(ACCESS_TOKEN));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"CLEAR TOKEN\"));\n    }\n  }]);\n\n  return LoginPage;\n}(Component);\n\nexport default LoginPage = connect()(LoginPage);","map":{"version":3,"sources":["/home/przemek/Data/Programowanie/PWr/ZPI/frontend/src/components/LoginPage.js"],"names":["React","Component","Redirect","Alert","ACCESS_TOKEN","userService","connect","LoginPage","props","context","login","dispatch","state","userInfo","email","password","console","log","JSON","stringify","fetch","method","headers","body","then","data","json","response","localStorage","setItem","accessToken","setState","redirectToReferer","catch","error","message","handleInput","event","target","name","value","prevState","pathname","getItem","removeItem"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,SAAQC,QAAR,QAAuB,kBAAvB;AACA,OAAOC,KAAP,MAAkB,eAAlB;AACA,SAAQC,YAAR,QAA2B,gBAA3B;AACA,SAAQC,WAAR,QAA0B,wBAA1B;AACA,SAAQC,OAAR,QAAsB,aAAtB;;IAEMC,S;;;;;AAEF,qBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;;AACxB,mFAAMD,KAAN,EAAaC,OAAb;;AADwB,UAW5BC,KAX4B,GAWpB,YAAM;AAAA,UACHC,QADG,GACU,MAAKH,KADf,CACHG,QADG,EAEV;AACA;;AACAA,MAAAA,QAAQ,CAACN,WAAW,CAACK,KAAZ,CAAkB,MAAKE,KAAL,CAAWC,QAAX,CAAoBC,KAAtC,EAA6C,MAAKF,KAAL,CAAWC,QAAX,CAAoBE,QAAjE,CAAD,CAAR;AAOAC,MAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAe,MAAKP,KAAL,CAAWC,QAA1B,CAAZ;AACAO,MAAAA,KAAK,CAAC,kCAAD,EAAqC;AACtCC,QAAAA,MAAM,EAAE,MAD8B;AAEtCC,QAAAA,OAAO,EAAE;AACL,0BAAgB;AADX,SAF6B;AAKtCC,QAAAA,IAAI,EAAEL,IAAI,CAACC,SAAL,CAAe,MAAKP,KAAL,CAAWC,QAA1B;AALgC,OAArC,CAAL,CAMGW,IANH,CAMQ,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAACC,IAAL,GAAYF,IAAZ,CACZ,UAAAG,QAAQ,EAAI;AACRC,UAAAA,YAAY,CAACC,OAAb,CAAqBzB,YAArB,EAAmCuB,QAAQ,CAACG,WAA5C;;AACA,gBAAKC,QAAL,CAAc;AAACC,YAAAA,iBAAiB,EAAE;AAApB,WAAd;AACH,SAJW,CAAJ;AAAA,OANZ,EAWGC,KAXH,CAWS,UAAAC,KAAK,EAAI;AACd/B,QAAAA,KAAK,CAAC+B,KAAN,CAAaA,KAAK,IAAIA,KAAK,CAACC,OAA5B;AACH,OAbD,EAZU,CA2BV;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAnB,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EArCU,CAsCV;AACH,KAlD2B;;AAAA,UAoD5BmB,WApD4B,GAoDd,UAACC,KAAD,EAAW;AAAA,0BAECA,KAAK,CAACC,MAFP;AAAA,UAEdC,IAFc,iBAEdA,IAFc;AAAA,UAERC,KAFQ,iBAERA,KAFQ;;AAGrB,UAAID,IAAI,KAAK,OAAb,EAAqB;AACjB,cAAKR,QAAL,CAAc,UAAAU,SAAS,EAAI;AACvBA,UAAAA,SAAS,CAAC5B,QAAV,CAAmBC,KAAnB,GAA2B0B,KAA3B;AACJ,iBAAOC,SAAP;AACC,SAHD;AAIH,OALD,MAKO,IAAIF,IAAI,KAAK,UAAb,EAAwB;AAC3B,cAAKR,QAAL,CAAc,UAAAU,SAAS,EAAI;AACvBA,UAAAA,SAAS,CAAC5B,QAAV,CAAmBE,QAAnB,GAA8ByB,KAA9B;AACA,iBAAOC,SAAP;AACH,SAHD;AAIH;AACJ,KAlE2B;;AAExB,UAAK7B,KAAL,GAAa;AACToB,MAAAA,iBAAiB,EAAE,KADV;AAETnB,MAAAA,QAAQ,EAAE;AACNC,QAAAA,KAAK,EAAE,EADD;AAENC,QAAAA,QAAQ,EAAE;AAFJ;AAFD,KAAb;AAFwB;AAS3B;;;;6BA2DQ;AAAA;;AAEL,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKH,KAAL,CAAWoB,iBAAX,GAA8B,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAE;AAACU,UAAAA,QAAQ,EAAE;AAAX,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAA9B,GAAsE,IAD3E,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAFJ,EAII;AAAO,QAAA,IAAI,EAAC,OAAZ;AAAoB,QAAA,IAAI,EAAC,MAAzB;AAAgC,QAAA,KAAK,EAAE,KAAK9B,KAAL,CAAWF,KAAlD;AAAyD,QAAA,QAAQ,EAAE,kBAAA2B,KAAK;AAAA,iBAAI,MAAI,CAACD,WAAL,CAAiBC,KAAjB,CAAJ;AAAA,SAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJJ,EAKI;AAAO,QAAA,IAAI,EAAC,UAAZ;AAAuB,QAAA,IAAI,EAAC,UAA5B;AAAuC,QAAA,KAAK,EAAE,KAAKzB,KAAL,CAAWG,QAAzD;AAAmE,QAAA,QAAQ,EAAE,kBAAAsB,KAAK;AAAA,iBAAI,MAAI,CAACD,WAAL,CAAiBC,KAAjB,CAAJ;AAAA,SAAlF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,EAMI;AAAQ,QAAA,OAAO,EAAE,KAAK3B,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANJ,EAOI;AAAQ,QAAA,OAAO,EAAE;AAAA,iBAAMM,OAAO,CAACC,GAAR,CAAY,MAAI,CAACL,KAAL,CAAWC,QAAvB,CAAN;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAPJ,EAQI;AAAQ,QAAA,OAAO,EAAE;AAAA,iBAAMG,OAAO,CAACC,GAAR,CAAYW,YAAY,CAACe,OAAb,CAAqBvC,YAArB,CAAZ,CAAN;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBARJ,EASI;AAAQ,QAAA,OAAO,EAAE;AAAA,iBAAMY,OAAO,CAACC,GAAR,CAAYW,YAAY,CAACgB,UAAb,CAAwBxC,YAAxB,CAAZ,CAAN;AAAA,SAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBATJ,CADJ;AAaH;;;;EArFmBH,S;;AA0FxB,eAAeM,SAAS,GAAGD,OAAO,GAAGC,SAAH,CAAlC","sourcesContent":["import React, {Component} from \"react\"\nimport {Redirect} from \"react-router-dom\";\nimport Alert from \"react-s-alert\"\nimport {ACCESS_TOKEN} from \"../constraints\";\nimport {userService} from \"../service/userService\";\nimport {connect} from \"react-redux\";\n\nclass LoginPage extends Component {\n\n    constructor(props, context) {\n        super(props, context);\n        this.state = {\n            redirectToReferer: false,\n            userInfo: {\n                email: \"\",\n                password: \"\",\n            }\n        }\n    }\n\n    login = () => {\n        const {dispatch } = this.props;\n        // console.log(this.state.userInfo.email);\n        // console.log(this.state.userInfo.password);\n        dispatch(userService.login(this.state.userInfo.email, this.state.userInfo.password));\n\n\n\n\n\n\n        console.log(JSON.stringify(this.state.userInfo));\n        fetch(\"http://localhost:3000/auth/login\", {\n            method: \"post\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(this.state.userInfo)\n        }).then(data => data.json().then(\n            response => {\n                localStorage.setItem(ACCESS_TOKEN, response.accessToken);\n                this.setState({redirectToReferer: true});\n            }\n        )).catch(error => {\n            Alert.error((error && error.message))\n        });\n\n        // then(data => console.log(data));\n\n\n        // console.log(this.state.data);\n        //\n        // this.props.auth.authenticate(() => {\n        //     this.setState(({\n        //         redirectToReferer: true,\n        //     }))\n        // });\n        console.log(\"Logged in!\");\n        // console.log(this.props.auth.isAuthenticated);\n    };\n\n    handleInput = (event) => {\n\n        const {name, value} = event.target;\n        if (name === 'email'){\n            this.setState(prevState => {\n                prevState.userInfo.email = value;\n            return prevState\n            });\n        } else if (name === 'password'){\n            this.setState(prevState => {\n                prevState.userInfo.password = value;\n                return prevState\n            });\n        }\n    };\n\n    render() {\n\n        return (\n            <div>\n                {this.state.redirectToReferer? <Redirect to={{pathname: '/index'}}/> : null}\n                <p>You must log in to view the page</p>\n\n                <input name='email' type='text' value={this.state.login} onChange={event => this.handleInput(event)}/>\n                <input name='password' type='password' value={this.state.password} onChange={event => this.handleInput(event)}/>\n                <button onClick={this.login}>Log in</button>\n                <button onClick={() => console.log(this.state.userInfo)}>LOG</button>\n                <button onClick={() => console.log(localStorage.getItem(ACCESS_TOKEN))}>LOG TOKEN</button>\n                <button onClick={() => console.log(localStorage.removeItem(ACCESS_TOKEN))}>CLEAR TOKEN</button>\n            </div>\n        )\n    }\n}\n\n\n\nexport default LoginPage = connect()(LoginPage);\n"]},"metadata":{},"sourceType":"module"}