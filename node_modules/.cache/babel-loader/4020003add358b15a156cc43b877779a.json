{"ast":null,"code":"import _classCallCheck from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/przemek/Data/Programowanie/PWr/ZPI/Teache/src/components/ChatComponent.js\";\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n    background-image: url(\", \");\\n    background-repeat: no-repeat;\\n    background-position: 0px 0px;\\n    background-size: contain;\\n    width: 30px;\\n    height: 30px;\\n    &:hover {\\n        width: 34px;\\n        height: 34px;\\n    }\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n      display: none;\\n    \"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n      width: 30px;\\n      height: 30px;\\n      &:hover {\\n        width: 34px;\\n        height: 34px;\\n      }\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n      display: grid;\\n      grid-template-columns: auto repeat(4, 42px);\\n      background-color: rgba(46, 21, 27, 0.9);\\n      align-items: center;\\n      justify-items: center;\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n      padding: 10px;\\n      background-color: rgba(255, 243, 230, 0.5);\\n      //opacity: 0.9;\\n      align-items: flex-end;\\n      //display: flex;\\n      //flex-direction: column-reverse;\\n      vertical-align: bottom;\\n      overflow-x: hidden;\\n      overflow-y: scroll;\\n      height: 75vh;\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    background-color: rgba(46, 21, 27, 0.9);\\n    h3 {\\n        text-align: center;\\n        padding-top: 15px;\\n        color: #CFD8DC;\\n    }\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    display: grid;\\n    grid-template-rows: 72px auto 42px;\\n    row-gap: 5px;\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from \"react\";\nimport Photo from '../assets/photo.png';\nimport Send from '../assets/send.png';\nimport File from '../assets/file.png';\nimport SendToken from \"../assets/sendToken.png\";\nimport styled from 'styled-components';\nimport { Messages } from \"../data/Messages\";\nimport { compose, graphql } from 'react-apollo';\nimport { GET_ME, getConversationGql } from '../queries/gql';\nimport * as ReactDOM from \"react-dom\";\nimport Message from \"./Message\";\nvar Chat = styled.div(_templateObject());\nvar Head = styled.div(_templateObject2());\nvar MessagesContainer = styled.div(_templateObject3());\nvar SendForm = styled.div(_templateObject4());\nvar FormImg = styled.img(_templateObject5());\nvar FileInput = styled.input(_templateObject6());\nvar FileInputLabel = styled.label(_templateObject7(), Photo);\n\nvar ChatComponent =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ChatComponent, _Component);\n\n  function ChatComponent() {\n    var _this;\n\n    _classCallCheck(this, ChatComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ChatComponent).call(this));\n\n    _this.getMessages = function () {\n      var data = _this.props.data.conversation;\n      var messages = data ? data.messages.map(function (message, index) {\n        var nickname = false;\n\n        if (index < 1 || message.sender.id !== data.messages[index - 1].sender.id) {\n          nickname = true;\n        }\n\n        return React.createElement(Message, {\n          key: index,\n          model: message,\n          isActive: message.sender.id === _this.props.userId,\n          showNickname: nickname,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        });\n      }) : [];\n      return messages;\n    };\n\n    _this.loadFile = function (event) {\n      event.preventDefault();\n      var file = event.target.files[0];\n\n      _this.props.sendImage(file);\n    };\n\n    _this.state = {\n      tokenFormVisible: false\n    };\n    return _this;\n  }\n\n  _createClass(ChatComponent, [{\n    key: \"scrollToBottom\",\n    value: function scrollToBottom() {\n      this.node.scrollTop = this.node.scrollHeight;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.scrollToBottom();\n    }\n    /*\n    const data = this.props.data.converstation;\n    const messages = data ? data.messages.map((message, index) => {\n         let nickname = null;\n         if(index < 1 || message.sender.id !== data.messages[index - 1].sender.id) {\n            nickname = message.sender.nickname;\n        }\n        \n        console.log('---')\n        console.log(message)\n        console.log()\n        console.log(index)\n        console.log('---')\n        return (\n            <Message\n            key={index}\n            model={message}\n            isActive={message.sender.id === this.props.userId}\n            user={nickname}>\n        </Message>)\n    } ) : [];\n    return messages;\n    */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var name = this.props.data.conversation ? this.props.data.conversation.name : \"\";\n      return React.createElement(Chat, {\n        id: \"chat\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(Head, {\n        className: \"chat-head\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, name)), React.createElement(MessagesContainer, {\n        ref: function ref(node) {\n          _this2.node = node;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, this.getMessages()), React.createElement(SendForm, {\n        className: \"send-form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        value: this.props.inputMessage,\n        type: \"text\",\n        onChange: this.props.onChange,\n        onKeyPress: this.props.onKeyPress,\n        className: \"form-control\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }), React.createElement(FormImg, {\n        src: SendToken,\n        alt: \"sendToken\",\n        onClick: this.props.onSendToken,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }), React.createElement(FileInput, {\n        accept: \"image/*\",\n        type: \"file\",\n        size: \"50\",\n        name: \"file\",\n        id: \"file\",\n        onChange: function onChange(event) {\n          return _this2.loadFile(event);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }), React.createElement(FileInputLabel, {\n        for: \"file\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), React.createElement(FormImg, {\n        src: Send,\n        alt: \"send\",\n        onClick: this.props.onClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return ChatComponent;\n}(Component);\n\nexport default compose(graphql(getConversationGql, {\n  options: function options(props) {\n    return {\n      variables: {\n        activeConversation: props.conversationID\n      },\n      pollInterval: 100,\n      fetchPolicy: \"network-only\"\n    };\n  }\n}))(ChatComponent);","map":{"version":3,"sources":["/home/przemek/Data/Programowanie/PWr/ZPI/Teache/src/components/ChatComponent.js"],"names":["React","Component","Photo","Send","File","SendToken","styled","Messages","compose","graphql","GET_ME","getConversationGql","ReactDOM","Message","Chat","div","Head","MessagesContainer","SendForm","FormImg","img","FileInput","input","FileInputLabel","label","ChatComponent","getMessages","data","props","conversation","messages","map","message","index","nickname","sender","id","userId","loadFile","event","preventDefault","file","target","files","sendImage","state","tokenFormVisible","node","scrollTop","scrollHeight","scrollToBottom","name","inputMessage","onChange","onKeyPress","onSendToken","onClick","options","variables","activeConversation","conversationID","pollInterval","fetchPolicy"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\"\nimport Photo from '../assets/photo.png'\nimport Send from '../assets/send.png'\nimport File from '../assets/file.png'\nimport SendToken from \"../assets/sendToken.png\"\nimport styled from 'styled-components'\nimport {Messages} from \"../data/Messages\";\nimport {compose, graphql} from 'react-apollo'\nimport {GET_ME, getConversationGql} from '../queries/gql'\nimport * as ReactDOM from \"react-dom\";\nimport Message from \"./Message\";\n\nconst Chat = styled.div`\n    display: grid;\n    grid-template-rows: 72px auto 42px;\n    row-gap: 5px;`;\n\nconst Head = styled.div`\n    background-color: rgba(46, 21, 27, 0.9);\n    h3 {\n        text-align: center;\n        padding-top: 15px;\n        color: #CFD8DC;\n    }`;\n\nconst MessagesContainer = styled.div`\n      padding: 10px;\n      background-color: rgba(255, 243, 230, 0.5);\n      //opacity: 0.9;\n      align-items: flex-end;\n      //display: flex;\n      //flex-direction: column-reverse;\n      vertical-align: bottom;\n      overflow-x: hidden;\n      overflow-y: scroll;\n      height: 75vh;`;\n\nconst SendForm = styled.div`\n      display: grid;\n      grid-template-columns: auto repeat(4, 42px);\n      background-color: rgba(46, 21, 27, 0.9);\n      align-items: center;\n      justify-items: center;`;\nconst FormImg = styled.img`\n      width: 30px;\n      height: 30px;\n      &:hover {\n        width: 34px;\n        height: 34px;\n      }`\n\nconst FileInput = styled.input`\n      display: none;\n    `\n\nconst FileInputLabel = styled.label`\n    background-image: url(${Photo});\n    background-repeat: no-repeat;\n    background-position: 0px 0px;\n    background-size: contain;\n    width: 30px;\n    height: 30px;\n    &:hover {\n        width: 34px;\n        height: 34px;\n    }`\n\nclass ChatComponent extends Component {\n\n    constructor() {\n        super()\n\n        this.state = {\n            tokenFormVisible: false\n        }\n    }\n\n    scrollToBottom() {\n        this.node.scrollTop = this.node.scrollHeight;\n    }\n\n    componentDidUpdate() {\n        this.scrollToBottom();\n    }\n\n    /*\n    const data = this.props.data.converstation;\n    const messages = data ? data.messages.map((message, index) => {\n\n        let nickname = null;\n\n        if(index < 1 || message.sender.id !== data.messages[index - 1].sender.id) {\n            nickname = message.sender.nickname;\n        }\n        \n        console.log('---')\n        console.log(message)\n        console.log()\n        console.log(index)\n        console.log('---')\n        return (\n            <Message\n            key={index}\n            model={message}\n            isActive={message.sender.id === this.props.userId}\n            user={nickname}>\n        </Message>)\n    } ) : [];\n    return messages;\n    */\n    getMessages = () => {\n        const data = this.props.data.conversation;\n        const messages = data ? data.messages.map((message, index) => {\n\n            let nickname = false;\n\n            if(index < 1 || message.sender.id !== data.messages[index - 1].sender.id) {\n                nickname = true;\n            }\n\n            return (\n                <Message\n                key={index}\n                model={message}\n                isActive={message.sender.id === this.props.userId}\n                showNickname={nickname}>\n            </Message>)\n        } ) : [];\n        return messages;\n    }\n\n    loadFile = (event) => {\n        event.preventDefault();\n        const file = event.target.files[0];\n\n        this.props.sendImage(file);\n    }\n\n    render() {\n        const name = this.props.data.conversation ? this.props.data.conversation.name : \"\";\n        return (\n            <Chat id='chat'>\n                <Head className='chat-head'>\n                    <h3>{name}</h3>\n                </Head>\n                <MessagesContainer ref={(node) => {\n                    this.node = node;\n                }}>\n                    {/* {Messages(this.props.userId, this.props.handleOver)} */}\n                    {this.getMessages()}\n                </MessagesContainer>\n                <SendForm className='send-form'>\n                    <input\n                        value={this.props.inputMessage}\n                        type='text'\n                        onChange={this.props.onChange}\n                        onKeyPress={this.props.onKeyPress}\n                        className='form-control'/>\n                    <FormImg src={SendToken} alt=\"sendToken\" onClick={this.props.onSendToken}/>\n                    <FileInput accept=\"image/*\" type=\"file\" size=\"50\" name=\"file\" id=\"file\" onChange={(event) => this.loadFile(event)} />\n                    <FileInputLabel for=\"file\" />\n                    <FormImg src={Send} alt='send'\n                             onClick={this.props.onClick}/>\n                </SendForm>\n\n\n            </Chat>)\n    }\n}\n\n\nexport default compose(graphql(getConversationGql, {\n    options: (props) => ({\n        variables: {\n            activeConversation: props.conversationID\n        },\n        pollInterval: 100,\n        fetchPolicy: \"network-only\"\n    })\n}))\n(ChatComponent);\n"]},"metadata":{},"sourceType":"module"}